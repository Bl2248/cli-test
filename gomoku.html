<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>五子棋游戏</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      background-color: #f0f0f0;
      margin: 0;
      padding: 20px;
    }

    h1 {
      color: #333;
    }

    .game-info {
      margin-bottom: 15px;
      font-size: 18px;
    }

    .status {
      font-weight: bold;
      color: #d9534f;
    }

    .board {
      display: grid;
      grid-template-columns: repeat(15, 30px);
      grid-template-rows: repeat(15, 30px);
      gap: 0;
      background-color: #dcb35c;
      border: 2px solid #8b4513;
      padding: 10px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.3);
    }

    .cell {
      width: 30px;
      height: 30px;
      border: 1px solid #8b4513;
      display: flex;
      justify-content: center;
      align-items: center;
      cursor: pointer;
      position: relative;
    }

    .cell::before {
      content: '';
      position: absolute;
      width: 100%;
      height: 100%;
      background: transparent;
    }

    .piece {
      width: 26px;
      height: 26px;
      border-radius: 50%;
      position: absolute;
      z-index: 2;
    }

    .black {
      background: radial-gradient(circle at 30% 30%, #ffffff, #000000);
      box-shadow: 0 2px 4px rgba(0,0,0,0.5);
    }

    .white {
      background: radial-gradient(circle at 30% 30%, #ffffff, #cccccc);
      box-shadow: 0 2px 4px rgba(0,0,0,0.3);
    }

    .controls {
      margin-top: 20px;
    }

    button {
      padding: 10px 20px;
      font-size: 16px;
      background-color: #5cb85c;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      margin: 0 5px;
    }

    button:hover {
      background-color: #4cae4c;
    }

    .winning-piece {
      box-shadow: 0 0 10px 3px #ffd700;
    }
  </style>
</head>
<body>
  <h1>五子棋游戏</h1>
  <div class="game-info">
    当前玩家: <span id="current-player" class="status">黑子</span>
  </div>
  <div class="board" id="board"></div>
  <div class="controls">
    <button id="restart-btn">重新开始</button>
  </div>

  <script>
    class GomokuGame {
      constructor() {
        this.boardSize = 15;
        this.board = Array(this.boardSize).fill().map(() => Array(this.boardSize).fill(0));
        this.currentPlayer = 1; // 1: 黑子, 2: 白子
        this.gameOver = false;
        this.winningLine = [];
        this.initBoard();
        this.bindEvents();
      }

      initBoard() {
        const boardElement = document.getElementById('board');
        boardElement.innerHTML = '';

        for (let row = 0; row < this.boardSize; row++) {
          for (let col = 0; col < this.boardSize; col++) {
            const cell = document.createElement('div');
            cell.className = 'cell';
            cell.dataset.row = row;
            cell.dataset.col = col;
            boardElement.appendChild(cell);
          }
        }
      }

      bindEvents() {
        const boardElement = document.getElementById('board');
        const restartBtn = document.getElementById('restart-btn');

        boardElement.addEventListener('click', (e) => {
          if (e.target.classList.contains('cell') && !this.gameOver) {
            const row = parseInt(e.target.dataset.row);
            const col = parseInt(e.target.dataset.col);
            this.makeMove(row, col);
          }
        });

        restartBtn.addEventListener('click', () => {
          this.restartGame();
        });
      }

      makeMove(row, col) {
        // 检查位置是否有效
        if (row < 0 || row >= this.boardSize || col < 0 || col >= this.boardSize) {
          return;
        }

        // 检查位置是否为空
        if (this.board[row][col] !== 0) {
          return;
        }

        // 放置棋子
        this.board[row][col] = this.currentPlayer;

        // 更新界面
        const cell = document.querySelector(`.cell[data-row="${row}"][data-col="${col}"]`);
        const piece = document.createElement('div');
        piece.className = `piece ${this.currentPlayer === 1 ? 'black' : 'white'}`;
        cell.appendChild(piece);

        // 检查胜负
        if (this.checkWin(row, col)) {
          this.gameOver = true;
          document.getElementById('current-player').textContent = 
            `${this.currentPlayer === 1 ? '黑子' : '白子'} 获胜！`;
          document.getElementById('current-player').style.color = '#5cb85c';
          
          // 高亮获胜棋子
          this.winningLine.forEach(([r, c]) => {
            const winCell = document.querySelector(`.cell[data-row="${r}"][data-col="${c}"]`);
            const piece = winCell.querySelector('.piece');
            if (piece) {
              piece.classList.add('winning-piece');
            }
          });
        } else {
          // 切换玩家
          this.currentPlayer = this.currentPlayer === 1 ? 2 : 1;
          document.getElementById('current-player').textContent = 
            this.currentPlayer === 1 ? '黑子' : '白子';
          document.getElementById('current-player').style.color = '#d9534f';
        }
      }

      checkWin(row, col) {
        const player = this.board[row][col];
        this.winningLine = [[row, col]];

        // 检查水平方向
        let count = 1;
        let r = row, c = col - 1;
        while (c >= 0 && this.board[r][c] === player) {
          count++;
          this.winningLine.push([r, c]);
          c--;
        }
        c = col + 1;
        while (c < this.boardSize && this.board[r][c] === player) {
          count++;
          this.winningLine.push([r, c]);
          c++;
        }
        if (count >= 5) return true;

        // 重置获胜线
        this.winningLine = [[row, col]];
        
        // 检查垂直方向
        count = 1;
        r = row - 1, c = col;
        while (r >= 0 && this.board[r][c] === player) {
          count++;
          this.winningLine.push([r, c]);
          r--;
        }
        r = row + 1;
        while (r < this.boardSize && this.board[r][c] === player) {
          count++;
          this.winningLine.push([r, c]);
          r++;
        }
        if (count >= 5) return true;

        // 重置获胜线
        this.winningLine = [[row, col]];
        
        // 检查左上到右下对角线
        count = 1;
        r = row - 1, c = col - 1;
        while (r >= 0 && c >= 0 && this.board[r][c] === player) {
          count++;
          this.winningLine.push([r, c]);
          r--;
          c--;
        }
        r = row + 1, c = col + 1;
        while (r < this.boardSize && c < this.boardSize && this.board[r][c] === player) {
          count++;
          this.winningLine.push([r, c]);
          r++;
          c++;
        }
        if (count >= 5) return true;

        // 重置获胜线
        this.winningLine = [[row, col]];
        
        // 检查右上到左下对角线
        count = 1;
        r = row - 1, c = col + 1;
        while (r >= 0 && c < this.boardSize && this.board[r][c] === player) {
          count++;
          this.winningLine.push([r, c]);
          r--;
          c++;
        }
        r = row + 1, c = col - 1;
        while (r < this.boardSize && c >= 0 && this.board[r][c] === player) {
          count++;
          this.winningLine.push([r, c]);
          r++;
          c--;
        }
        if (count >= 5) return true;

        return false;
      }

      restartGame() {
        this.board = Array(this.boardSize).fill().map(() => Array(this.boardSize).fill(0));
        this.currentPlayer = 1;
        this.gameOver = false;
        this.winningLine = [];
        document.getElementById('current-player').textContent = '黑子';
        document.getElementById('current-player').style.color = '#d9534f';
        this.initBoard();
      }
    }

    // 启动游戏
    document.addEventListener('DOMContentLoaded', () => {
      new GomokuGame();
    });
  </script>
</body>
</html>